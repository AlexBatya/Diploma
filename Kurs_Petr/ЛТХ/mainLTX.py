import numpy as np 
import matplotlib.pyplot as plt 
import pandas as pd
# import Callculation as cal
from close import runSingle
from scipy.interpolate import interp1d, interp2d 

#Исзодные данные
mass = 180000
S=360

Ha =[0,500,1000,1500,2000,2500,3000,3500,4000,4500,5000,5500,6000,6500,7000,7500,8000,8500,9000,9500,10000,10500,11000,11500,12000,12500,13000,13500,14000,14500,15000,15500,16000,16500,17000,17500,18000,18500,19000,19500,20000,20500,21000,21500,22000,22500,23000,23500,24000,24500,25000,25500,26000,26500,27000,27500,28000,28500,29000,29500,30000]
pa =[101325,95461.3000000000,89876.3000000000,84559.7000000000,79501.4000000000,74691.7000000000,70121.2000000000,65780.4000000000,61660.4000000000,57752.6000000000,54048.3000000000,50539.3000000000,47217.6000000000,44075.5000000000,41105.3000000000,38299.7000000000,35651.6000000000,33154.2000000000,30800.7000000000,28584.7000000000,26499.9000000000,24540.2000000000,22699.9000000000,20984.7000000000,19399.4000000000,17934,16579.6000000000,15327.6000000000,14170.3000000000,13100.6000000000,12111.8000000000,11197.7000000000,10352.8000000000,9571.70000000000,8849.70000000000,8182.20000000000,7565.20000000000,6994.80000000000,6467.50000000000,5978,5529.30000000000,5113,4729,4374.60000000000,4047.50000000000,3745.60000000000,3466.90000000000,3209.50000000000,2971.70000000000,2752.10000000000,2549.20000000000,2361.70000000000,2188.40000000000,2028.10000000000,1880,1743,1616.20000000000,1499,1390.40000000000,1290,1197]
a = [340.400000000000,338.500000000000,336,334.800000000000,332.700000000000,330.700000000000,328.700000000000,326.700000000000,324.700000000000,322.700000000000,320.700000000000,318.600000000000,316.600000000000,314.500000000000,312.400000000000,310.300000000000,308.200000000000,306.100000000000,303.900000000000,301.800000000000,299.600000000000,299.400000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000,295.200000000000]
Cx01 = [0.0175000000000000,0.0175000000000000,0.0175500000000000,0.0175655000000000,0.0180000000000000,0.0192000000000000,0.0223000000000000,0.0220000000000000,0.0218500000000000,0.0216000000000000,0.0215000000000000,0.0215500000000000]
A1 = [0.0250000000000000,0.0250000000000000,0.0247000000000000,0.0242000000000000,0.0237000000000000,0.0256000000000000,0.0340000000000000,0.0380000000000000,0.0420000000000000,0.0445000000000000,0.0475000000000000,0.0498000000000000]
H1=[0,3000,6000,9000,11000,14000,17000,20000,23000,26000,29000]
M1 = [0.0300000000000000,0.250000000000000,0.500000000000000,0.750000000000000,1,1.25000000000000,1.50000000000000,1.75000000000000,2,2.25000000000000,2.50000000000000,2.75000000000000]
P01 = [[1.65000000000000,1.67000000000000,1.70000000000000,1.75000000000000,1.90000000000000,2.05000000000000,2.10000000000000,2.11000000000000,2.12000000000000,2.15000000000000,2.20000000000000,2.23000000000000],
    [1.32000000000000,1.34000000000000,1.40000000000000,1.50000000000000,1.65000000000000,1.78000000000000,1.90000000000000,1.95000000000000,2,2.05000000000000,2.10000000000000,2.11000000000000],
    [1.10000000000000,1.09500000000000,1.14000000000000,1.23000000000000,1.35000000000000,1.47000000000000,1.62000000000000,1.70000000000000,1.75000000000000,1.78000000000000,1.82000000000000,1.82000000000000],
    [0.850000000000000,0.835000000000000,0.900000000000000,0.970000000000000,1.10000000000000,1.25000000000000,1.40000000000000,1.50000000000000,1.53000000000000,1.56000000000000,1.60000000000000,1.60000000000000],
    [0.632430000000000,0.650000000000000,0.700000000000000,0.760000000000000,0.850000000000000,1.10000000000000,1.25000000000000,1.40000000000000,1.50000000000000,1.56000000000000,1.70000000000000,1.70000000000000]]
Ce01 = [[1.86433000000000,1.83932000000000,1.90112000000000,2.04974000000000,2.20600000000000,2.31900000000000,2.39700000000000,2.46000000000000,2.51000000000000,2.53973000000000,2.57063000000000,2.58240000000000],
    [1.80493818181818,1.77832181818182,1.83691181818182,1.97028090909091,2.12049727272727,2.24517090909091,2.31393000000000,2.37184727272727,2.41880090909091,2.45184363636364,2.47752636363636,2.48608636363636],
    [1.74554636363636,1.71732363636364,1.77270363636364,1.89082181818182,2.04264454545455,2.16250181818182,2.23086000000000,2.29078454545455,2.33613181818182,2.36395727272727,2.38442272727273,2.38977272727273],
    [1.68615454545455,1.65632545454545,1.70849545454545,1.81136272727273,1.96479181818182,2.07983272727273,2.14779000000000,2.20972181818182,2.25346272727273,2.27607090909091,2.29131909090909,2.29345909090909],
    [1.64656000000000,1.61566000000000,1.66569000000000,1.76600000000000,1.91289000000000,2.02472000000000,2.09700000000000,2.15568000000000,2.19835000000000,2.21748000000000,2.22925000000000,2.22925000000000]
    ]

H_interp = np.arange(H1[0],H1[-1],1000)     # Разбиваем данныые для интерполяции
M_interp = np.arange(M1[0],M1[-1],0.001)

for i in range(len(H1)):     #Добавляет в массивы тяг и расходов данные выше 11 км (они постоянные )
    if H1[i] > 11000:
        P01.append(P01[-1])
        Ce01.append(Ce01[-1])

method = 'cubic'

A = interp1d(M1, A1,method)  # Сразу интерполируем весь этот калл дабы потом было удобно с этим работать
Cx0 = interp1d(M1, Cx01,method)
p = interp1d(Ha, pa,method)
a = interp1d(Ha, a,method)
P0 = interp2d(M1,H1,P01,method)
Ce0 = interp2d(M1,H1,Ce01,method)


Mmax =  [1.6202,1.9,2.2,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.3]   # Не принципиальное поле 
Mmin = [0.28,0.333,0.407,0.503,0.55,0.63,0.82,1.1,1.46,1.9,2.25,2.3] # Это для расчёта Траектории набора
M2 = np.array([Mmin,Mmax]).T 
n = np.size(M2,0)
number = 10
M = []

for i in range(n):
    M.append(np.linspace(M2[i][0],M2[i][-1],number)) #разбиения области на узловые точки

from Ppotr import Pp
print(Pp(1,2000))